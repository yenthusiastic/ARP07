### 1. Development platform installations
Development platform for GUI: Windows 10
#### 1.1. Installing Python 3.5
##### Option 1: Direct installation
Download and install [Python 3.5 for Windowss](https://www.python.org/downloads/windows/) (tested working with v3.5.3)
##### Option 2: Miniconda virtual environment
Install [Miniconda](https://docs.conda.io/en/latest/miniconda.html#) (comes with Python 3.7.3 and allows development in virtual environment)
#### 1.2. Installing PyQt for GUI app development
##### Option 1: Install from executable
- Download the PyQt5-5.6-gpl-Py3.5-Qt5.6.0-x64-2.exe from [this link](https://sourceforge.net/projects/pyqt/files/PyQt5/PyQt-5.6/) and execute it to install QtDesigner.
- Launch QtDesigner from Start Menu.
##### Option 2: Install using `pip` Python package manager
- In Commmand Line/ Anaconda Prompt, type in:
```bash
pip install PyQt5
pip install pyqt5-tools
```
- To launch QtDesigner, go to `C:\Users\***\AppData\Local\Programs\Python\Python35\Lib\site-packages\pyqt5_tools` and launch `designer.exe` 
*(replace `***` with corresponding username on Windows)*

A quick guide to PyQt can be found [here](https://www.pythonforengineers.com/your-first-gui-app-with-python-and-pyqt/).

#### 1.3. Install OpenCV
- In Commmand Line/ Anaconda Prompt, type in:
```bash
pip install opencv-contrib-python
pip install numpy matplotlib
```
#### 1.4. Using UI file generated by QtDesigner in main program
##### Option 1: Directly load UI files generated by PyQt
Example code: 
```bash
from PyQt5 import uic, QtWidgets
import sys

class Ui(QtWidgets.QDialog):
    def __init__(self):
        super(Ui, self).__init__()
        uic.loadUi('GUI_design.ui', self)
        self.show()

if __name__ == '__main__':
    app = QtWidgets.QApplication(sys.argv)
    window = Ui()
    sys.exit(app.exec_())
```
This option causes more overhead and prevents support for code completion.
##### Option 2: Use pyuic to compile UI file as Python class
```bash
pyuic5.exe gui.ui -o gui.py -x
```
This option is a bit more inconvenient as the UI file has to be recompiled every time changes are made to the GUI design. However, code completion is supporrted with this method.

#### 1.5. Threading in PyQt5 GUI app
If threading is not used, trying to fetch data from other classes will cause following problems:
- The main thread is locked
- The GUI isn't updated until the process finishes
- All GUI elements are no longer functional even though they appear to be.
- No way to stop the execution once the function is started.
Check [this tutorial](https://nikolak.com/pyqt-threading-tutorial/) for more info.


### 2. Raspberry Pi 3 (B) installations
Running platform: Raspberry Pi 3 Model B
#### 2.1. Prerequisites
Built-in Python and pip:
- Python version: 3.5
- pip3 package manager 
#### 2.2. Install PyQt5
**NOTE:** To avoid long installing time, the complete OS image with PyQt5 was made on 13.06.19. See instructions [here](image_instructions.md).

##### For manual installations:
- Install dependencies
```bash
sudo apt-get update
sudo apt-get install qt5-default pyqt5-dev pyqt5-dev-tools
```
At this point, running `sudo apt-get install PyQt5` WILL NOT WORK on Raspbian. Instead have to build the library from source. On the Pi, download [sip-4.*.*.tar.gz](https://www.riverbankcomputing.com/software/sip/download) and [PyQt5_gpl-5.*.*.tar.gz](https://www.riverbankcomputing.com/software/pyqt/download5). Then run following command to extract them:
```bash
tar -xzvf sip-4.**.tar.gz
tar -xzvf PyQt5_gpl-5.**.tar.gz
```
- First have to build SIP:
```bash
cd sip-4.**
python3 configure.py
make
sudo make install
```
- When finished, repeat the same steps for building PyQt5
```bash
cd PyQt5_gpl-5.**
python3 configure.py --sip-module PyQt5.sip   #if this does not work, try 
python3 configure.py
make
sudo make install
```
#### 2.3. Install Seabreeze Library for handling spectrometers
**NOTE:** To avoid long installing time, the complete OS image with PyQt5 and Seabreeze was made on 09.07.19. See instructions [here](image_instructions.md).

##### For manual installations:
* Clone the library from [this git repo](https://github.com/ap--/python-seabreeze).

* Get packages required for installing python-seabreeze without conda:
```bash
sudo apt-get install git-all build-essential libusb-dev
```
* Install the C library backend. Script is located in the `misc` folder inside the above git repo:
```bash
./install_libseabreeze.sh
```

  * Setup the udev rules. There's another helper script in the `misc` folder:
```bash
./install_udev_rules.sh
```

* Install Cython to build cseabreeze:
```bash
pip install cython
```

* After that go to the repository root and run:
```bash
pip install .
```


#### 2.4. Install OpenCV
**NOTE:** To avoid long installing time, the complete OS image with PyQt5, Seabreeze and OpenCV was made on 12.07.19. See instructions [here](image_instructions.md).

##### For manual installations:
Use the [install_opencv4.sh](../misc/install_opencv4.sh) installation script to install OpenCV.

**IMPORTANT - Perform following steps before executing the script:**
- Increase the SWAP on the Pi by changing CONF_SWAPSIZE in the file `/etc/dphys-swapfile`. If you do not perform this step itâ€™s very likely that your Pi will hang.
```
sudo nano /etc/dphys-swapfile
```
- In this file, change `CONF_SWAPSIZE=2048`. Then restart the SWAP service:        
```
sudo /etc/init.d/dphys-swapfile stop
sudo /etc/init.d/dphys-swapfile start
```
- Execute the installation script
```bash
bash install_opencv.sh
```
Alternatively, follow the steps in [this tutorial](https://www.pyimagesearch.com/2018/09/26/install-opencv-4-on-your-raspberry-pi/).

- Upon successful compilation, don't forget to go back to `/etc/dphys-swapfile` file and edit it:
   - Reset CONF_SWAPSIZE to 100MB.
   - Restart the swap service.

NOTE: Initially `openCV` was compiled successfully and tested working with `python3`. However, when using `sudo python3` it could not find the module. To resolve this, perform following steps:
```
python3 -m site --user-site
```
With user pi, this command returns `/home/pi/.local/lib/python3.5/site-packages` where cv2 is saved. Using root (sudo) the command returns `/root/.local/lib/python3.5/site-packages`. However, this directory does not exist. To create this folder:
```
sudo mkdir root/.local
sudo mkdir root/.local/lib
sudo mkdir root/.local/lib/python3.5
sudo mkdir root/.local/lib/python3.5/site-packages
```
Then, cv2 from user pi can be copied over (symlink should also work).


#### 2.5. Installing additional libraries:
NOTE: To avoid long installing time, the complete OS image with PyQt5, Seabreeze and OpenCV and all dependencies was made on 12.07.19. See instructions [here](image_instructions.md).

##### For manual installation:
###### Adafruit Neopixel library 
```
pip3 install rpi_ws281x adafruit-circuitpython-neopixel
```
###### Adafruit ADC module
```
pip3 install adafruit-circuitpython-ads1x15 
```
###### PyQtGraph
```
sudo apt install python3-pyqtgraph
```
